function makeSentence(){var e="Votre recherche actuelle liste les films";yearfrom>0&&(e+=yearto>0?yearfrom==yearto?" en "+yearfrom:" entre "+yearfrom+" et "+yearto:" en "+yearfrom),category>0&&(e+=" dans la catÃ©gorie "+category),e+=".",$("#sentence").text(e)}function getCards(){$parameters={count:0},"undefined"!=typeof category&&category>0&&$.extend($parameters,{category:category}),"undefined"!=typeof lattop&&lattop>0&&$.extend($parameters,{lattop:lattop}),"undefined"!=typeof lngtop&&lngtop>0&&$.extend($parameters,{lngtop:lngtop}),"undefined"!=typeof latbottom&&latbottom>0&&$.extend($parameters,{latbottom:latbottom}),"undefined"!=typeof category&&category>0&&$.extend($parameters,{category:category}),"undefined"!=typeof lngbottom&&lngbottom>0&&$.extend($parameters,{lngbottom:lngbottom}),"undefined"!=typeof yearfrom&&yearfrom>0&&$.extend($parameters,{yearfrom:yearfrom}),"undefined"!=typeof yearto&&yearto>0&&$.extend($parameters,{yearto:yearto});var e,t;$.get("/rest/cards",$parameters,function(o){if(mapMarkers.length>0)for(t=0;t<mapMarkers.length;t++)mapMarkers[t].setMap(null);mapMarkers=[],markers=[],infowindows=[],$.each(o.cards,function(e,t){markers.push([t.title,t.location_lat,t.location_long]),infowindows.push(["<h2>"+t.title+"</h2><p>"+t.description+"</p>"])});var a=new google.maps.InfoWindow;for(t=0;t<markers.length;t++){var r=new google.maps.LatLng(markers[t][1],markers[t][2]);bounds.extend(r),e=new google.maps.Marker({position:r,map:map,title:markers[t][0]}),mapMarkers.push(e),google.maps.event.addListener(e,"click",function(e,t){return function(){a.setContent(infowindows[t][0]),a.open(map,e)}}(e,t)),map.fitBounds(bounds)}})}var category=0,yearfrom=0,yearto=0,lattop=0,lngtop=0,latbottom=0,lngbottom=0,map,markers=[],mapMarkers=[],infowindows,bounds=new google.maps.LatLngBounds,mapOptions={mapTypeId:"roadmap"};jQuery(function(){var e=[{stylers:[{visibility:"simplified"}]},{stylers:[{color:"#121212"}]},{featureType:"water",stylers:[{color:"#121212"},{lightness:0}]},{featureType:"landscape",stylers:[{color:"#121212"},{lightness:35}]},{elementType:"labels.text.fill",stylers:[{visibility:"on"},{lightness:100}]}];$=jQuery.noConflict(),$ajaxLoader='<div class="ajax-loader"></div>';var t=new google.maps.LatLng(50.833,4.333);map=new google.maps.Map(document.getElementById("google-map"),{zoom:3,center:t,mapTypeId:google.maps.MapTypeId.ROADMAP,panControl:0,zoomControl:0,mapTypeControl:0,scaleControl:1,streetViewControl:0,styles:e,overviewMapControl:0}),$(document).on("click",".ajax",function(e){e.preventDefault();var t=$(this);return href=t.attr("href"),$("#add .modal-body").load(href+" #content"),$("#add").modal(),!1}),$(document).on("click",".category-selector",function(e){var t=$(this);category=t.data("id")}),$(document).on("change, keyup","#yearfrom",function(e){var t=$(this);""!=t.val()&&t.val().length>=4&&(yearfrom=t.val())}),$(document).on("change, keyup","#yearto",function(e){var t=$(this);""!=t.val()&&t.val().length>=4&&(yearto=t.val(),"undefined"!=typeof yearfrom&&yearfrom>yearto&&(yearto=yearfrom),("undefined"==typeof yearfrom||0==yearfrom)&&(yearfrom=yearto))}),$(document).on("click","#apply",function(e){makeSentence(),getCards()})}),getCards();