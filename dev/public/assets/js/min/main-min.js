function makeSentence(){var e="Votre recherche actuelle liste les films";yearfrom>0&&(e+=yearto>0?yearfrom==yearto?" en "+yearfrom:" entre "+yearfrom+" et "+yearto:" en "+yearfrom),category>0&&(e+=" dans la catÃ©gorie "+category),e+=".",$("#sentence").text(e),getCards()}function getCards(){$parameters={count:0},"undefined"!=typeof category&&category>0&&$.extend($parameters,{category:category}),"undefined"!=typeof lattop&&lattop>0&&$.extend($parameters,{lattop:lattop}),"undefined"!=typeof lngtop&&lngtop>0&&$.extend($parameters,{lngtop:lngtop}),"undefined"!=typeof latbottom&&latbottom>0&&$.extend($parameters,{latbottom:latbottom}),"undefined"!=typeof category&&category>0&&$.extend($parameters,{category:category}),"undefined"!=typeof lngbottom&&lngbottom>0&&$.extend($parameters,{lngbottom:lngbottom}),"undefined"!=typeof yearfrom&&yearfrom>0&&$.extend($parameters,{yearfrom:yearfrom}),"undefined"!=typeof yearto&&yearto>0&&$.extend($parameters,{yearto:yearto});var e,o;$.get("/rest/cards",$parameters,function(t){if(mapMarkers.length>0)for(o=0;o<mapMarkers.length;o++)mapMarkers[o].setMap(null);mapMarkers=[],markers=[],infowindows=[],$.each(t.cards,function(e,o){markers.push([o.title,o.location_lat,o.location_long]),infowindows.push(["<h2>"+o.title+"</h2><p>"+o.description+"</p>"])});var a=new google.maps.InfoWindow;for(o=0;o<markers.length;o++){var n=new google.maps.LatLng(markers[o][1],markers[o][2]);bounds.extend(n),e=new google.maps.Marker({position:n,map:map,title:markers[o][0]}),mapMarkers.push(e),google.maps.event.addListener(e,"click",function(e,o){return function(){a.setContent(infowindows[o][0]),a.open(map,e)}}(e,o)),map.fitBounds(bounds)}})}var category=0,yearfrom=0,yearto=0,lattop=0,lngtop=0,latbottom=0,lngbottom=0,map,markers=[],mapMarkers=[],infowindows,bounds=new google.maps.LatLngBounds,mapOptions={mapTypeId:"roadmap"};jQuery(function(){var e=[{stylers:[{visibility:"simplified"}]},{stylers:[{color:"#121212"}]},{featureType:"water",stylers:[{color:"#121212"},{lightness:0}]},{featureType:"landscape",stylers:[{color:"#121212"},{lightness:35}]},{elementType:"labels.text.fill",stylers:[{visibility:"on"},{lightness:100}]}];$=jQuery.noConflict(),$ajaxLoader='<div class="ajax-loader"></div>';var o=new google.maps.LatLng(50.833,4.333);if(map=new google.maps.Map(document.getElementById("google-map"),{zoom:3,center:o,mapTypeId:google.maps.MapTypeId.ROADMAP,panControl:0,zoomControl:0,mapTypeControl:0,scaleControl:1,streetViewControl:0,styles:e,overviewMapControl:0}),$(document).on("click",".ajax",function(e){e.preventDefault();var o=$(this);return href=o.attr("href"),$("#ajax .modal-body").load(href+" #content"),$("#ajax").modal(),!1}),$(document).on("click",".slideRight",function(e){return e.preventDefault(),$("#slideRight").modal(),!1}),$(document).on("click",".category-selector",function(e){var o=$(this);category=o.data("id"),makeSentence()}),$(document).on("change, keyup","#yearfrom",function(e){var o=$(this);""!=o.val()&&o.val().length>=4&&(yearfrom=o.val())}),$(document).on("change, keyup","#yearto",function(e){var o=$(this);""!=o.val()&&o.val().length>=4&&(yearto=o.val(),"undefined"!=typeof yearfrom&&yearfrom>yearto&&(yearto=yearfrom),("undefined"==typeof yearfrom||0==yearfrom)&&(yearfrom=yearto))}),$(document).on("click","#apply",function(e){makeSentence(),getCards()}),$("#geolocation_address").length){var t=$("#geolocation_address").val(),a=$("#geolocation_latitude").val(),n=$("#geolocation_longitude").val(),o=""==a&&""==n?new google.maps.LatLng(50.833,4.333):new google.maps.LatLng(a,n),r=new google.maps.Map(document.getElementById("geolocation-google-map"),{zoom:8,center:o,mapTypeId:google.maps.MapTypeId.ROADMAP,panControl:0,zoomControl:0,mapTypeControl:0,scaleControl:0,streetViewControl:0,overviewMapControl:0}),l=new google.maps.Marker({position:o,map:r,draggable:!0});r.addListener(l,"drag",function(){var e=l.getPosition();$("#geolocation_latitude").val(e.lat()),$("#geolocation_latitude_shown").val(e.lat()),$("#geolocation_longitude").val(e.lng()),$("#geolocation_longitude_shown").val(e.lng())}),$(document).on("change, keyup","#geolocation_address",function(e){var o=$(this);if(""!=o.val()&&o.val().length>=3){var t=new google.maps.Geocoder;t.geocode({address:o.val()},function(e,o){if(o==google.maps.GeocoderStatus.OK){var t=e[0].geometry.location;r.setCenter(t),l.setPosition(t),map.getZoom()<12&&map.setZoom(12),$("#geolocation-new-coordinates").show(),$("#geolocation_new_latitude").val(e[0].geometry.location.lat()),$("#geolocation_new_longitude").val(e[0].geometry.location.lng())}})}}),$(document).on("click","#geolocation-use-new",function(e){e.preventDefault(),$("#geolocation_latitude").val($("#geolocation_new_latitude").val()),$("#geolocation_latitude_shown").val($("#geolocation_new_latitude").val()),$("#geolocation_longitude").val($("#geolocation_new_longitude").val()),$("#geolocation_longitude_shown").val($("#geolocation_new_longitude").val())})}$(function(){$("#slider").slider({range:!0,min:1980,max:2015,values:[2e3,2014],slide:function(e,o){yearfrom=o.values[0],yearto=o.values[1],makeSentence(),$("#slider").find(".ui-slider-handle").first().text(yearfrom),$("#slider").find(".ui-slider-handle").last().text(yearto)},create:function(e,o){yearfrom=2e3,yearto=2014,makeSentence(),console.log("test"),$("#slider").find(".ui-slider-handle").first().text(yearfrom),$("#slider").find(".ui-slider-handle").last().text(yearto)}})})}),$(".custom-select").fancySelect(),getCards();